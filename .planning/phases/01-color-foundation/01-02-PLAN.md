---
phase: 01-color-foundation
plan: 02
type: execute
wave: 2
depends_on:
  - "01-01"
files_modified:
  - _sass/custom.scss
  - _includes/head.html
autonomous: false
requirements:
  - CLR-01
  - CLR-02
  - CLR-03
  - CLR-04
  - CLR-05

must_haves:
  truths:
    - "Site background is dark grey (#1e1f22), not purple (#262335), on every page"
    - "All surface colors (header, cards, hover states, borders) are neutral greys with no purple tint"
    - "Page loads show no color flash -- critical CSS matches the stylesheet"
    - "Every text/background combination passes WCAG AA contrast (4.5:1 minimum)"
    - "Scrollbar, text selection, and accent elements reflect the new palette"
  artifacts:
    - path: "_sass/custom.scss"
      provides: "Complete new color palette in :root block"
      contains: "--bg-primary: #1e1f22"
    - path: "_includes/head.html"
      provides: "Critical CSS synced with new palette"
      contains: "background-color: #1e1f22"
  key_links:
    - from: "_includes/head.html"
      to: "_sass/custom.scss"
      via: "Inline critical CSS values must match :root variable values exactly"
      pattern: "#1e1f22"
    - from: "_sass/custom.scss"
      to: "all pages"
      via: "CSS custom properties cascade to every element using var() references"
      pattern: "--bg-primary: #1e1f22"
---

<objective>
Swap the entire color palette from purple-tinted dark to Discord-inspired neutral dark grey in a single atomic change, and sync the critical CSS in head.html to prevent color flash on page load.

Purpose: This is the core deliverable of Phase 1 -- replacing every color in the site with the new contrast-verified neutral palette.
Output: Two files modified -- _sass/custom.scss (:root palette swapped), _includes/head.html (critical CSS synced)
</objective>

<execution_context>
@/home/chris/.claude/get-shit-done/workflows/execute-plan.md
@/home/chris/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/01-color-foundation/01-RESEARCH.md
@.planning/phases/01-color-foundation/01-01-SUMMARY.md
@_sass/custom.scss
@_includes/head.html
</context>

<tasks>

<task type="auto">
  <name>Task 1: Atomic palette swap and critical CSS sync</name>
  <files>_sass/custom.scss, _includes/head.html</files>
  <action>
  Make ALL color changes as a single atomic edit across both files. Do NOT partially update -- change every value listed below.

  1. In `_sass/custom.scss`, replace the entire `:root` block (lines 12-22) with the new palette:
     ```scss
     :root {
         --bg-primary: #1e1f22;
         --bg-header: #111214;
         --bg-surface: #2b2d31;
         --bg-hover: #35373c;
         --border: #3f4147;
         --text-primary: #f2f3f5;
         --text-muted: #949ba4;
         --accent: #9b84ec;
         --accent-dim: #8a7dd0;
     }
     ```

  2. In `_includes/head.html`, update the critical CSS inline style (lines 13-19) to match the new :root values:
     ```html
     <style>
       html, body {
         background-color: #1e1f22;
         color: #f2f3f5;
         margin: 0;
         padding: 0;
         font-family: 'JetBrains Mono', monospace;
       }
     </style>
     ```

  3. After both edits, scan `_sass/custom.scss` for any remaining hardcoded hex colors that reference the OLD palette. Specifically search for these old values that should NOT exist:
     - `#262335` (old bg-primary)
     - `#241b2f` (old bg-header)
     - `#2a2139` (old bg-surface)
     - `#34294f` (old bg-hover/border)
     - `#848bbd` (old text-muted)
     - `#ff7edb` (old accent pink)
     - `#f97e72` (old accent-dim coral)

     If any old hex values are found outside the :root block, they are hardcoded colors that need converting to var() references.

  4. Similarly scan `_includes/head.html` for any remaining old values (`#262335`, `#ffffff`).

  WCAG contrast reference (all pre-verified, no calculation needed):
  - text-primary (#f2f3f5) on bg-primary (#1e1f22): 14.84:1 -- PASS
  - text-muted (#949ba4) on bg-primary (#1e1f22): 5.87:1 -- PASS
  - accent (#9b84ec) on bg-primary (#1e1f22): 5.42:1 -- PASS
  - text-primary on bg-surface (#2b2d31): 12.42:1 -- PASS
  - text-muted on bg-surface: 4.92:1 -- PASS
  - accent on bg-surface: 4.54:1 -- PASS
  - accent-dim (#8a7dd0) on bg-primary: 4.65:1 -- PASS
  </action>
  <verify>
  1. Run `grep '#262335\|#241b2f\|#2a2139\|#34294f\|#848bbd\|#ff7edb\|#f97e72' _sass/custom.scss _includes/head.html` -- should return zero matches (no old palette values remain)
  2. Run `grep '#1e1f22' _sass/custom.scss _includes/head.html` -- should match in both files (new bg-primary in :root AND critical CSS)
  3. Run `grep '#f2f3f5' _sass/custom.scss _includes/head.html` -- should match in both files (new text-primary in :root AND critical CSS)
  4. Run `bundle exec jekyll build` -- should succeed with no errors
  </verify>
  <done>
  - All 9 CSS custom property values updated to new neutral grey palette
  - Critical CSS in head.html synced with new bg-primary (#1e1f22) and text-primary (#f2f3f5)
  - Zero old palette hex values remain anywhere in the modified files
  - Site builds successfully
  </done>
</task>

<task type="auto">
  <name>Task 2: Build verification and contrast audit</name>
  <files>_sass/custom.scss</files>
  <action>
  1. Run `bundle exec jekyll build` and verify clean build.

  2. Inspect the compiled CSS at `_site/assets/css/style.css`:
     - Confirm `:root` block contains all 9 new color values
     - Confirm no old purple hex values appear anywhere in the compiled output
     - Confirm `body a` selectors (from Plan 01) use `var(--text-primary)` without `!important`

  3. Search the compiled CSS output for any hex colors that are NOT in the new palette and NOT standard web values (#000, #fff, transparent). These could be Minima default colors leaking through or previously hidden hardcoded values now visible.

  4. Inspect the built HTML files (`_site/index.html`, any post page) to confirm the inline critical CSS in the head contains `#1e1f22` and `#f2f3f5`.

  5. If any issues found (old colors, Minima leakage, hardcoded values), fix them in the source files. All fixes should use CSS custom property references (var(--*)) rather than new hardcoded hex values.
  </action>
  <verify>
  1. `bundle exec jekyll build` completes cleanly
  2. `grep '#262335\|#241b2f\|#2a2139\|#ff7edb' _site/assets/css/style.css` returns zero matches
  3. `grep '#1e1f22' _site/index.html` confirms critical CSS is synced
  4. `grep -c 'var(--' _sass/custom.scss` shows high usage of CSS variables (no regression from hardcoded values)
  </verify>
  <done>
  - Compiled CSS contains exclusively the new palette values
  - Built HTML pages contain synced critical CSS
  - No old palette colors remain in any build output
  - No Minima default colors leak through
  </done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <name>Task 3: Visual verification of complete palette swap</name>
  <what-built>Complete color palette swap from purple-tinted dark theme to Discord-inspired neutral dark grey. Background changed from #262335 to #1e1f22, accent from pink (#ff7edb) to purple (#9b84ec), all surface colors shifted to neutral greys. Critical CSS synced to prevent color flash.</what-built>
  <how-to-verify>
    1. Run `bundle exec jekyll serve` in the project root
    2. Open http://localhost:4000 in your browser (use hard refresh: Ctrl+Shift+R)
    3. Check these items on the homepage:
       - Background is dark grey (not purple)
       - Header background is darker grey
       - Post cards have neutral grey background with grey border
       - Post card titles are purple (#9b84ec), not pink
       - Dates/metadata text is readable grey
       - Hovering post cards shows grey hover state (no purple tint)
    4. Click into a blog post and check:
       - Background is consistent dark grey
       - Body text is slightly off-white (#f2f3f5), readable
       - Blockquote border is purple accent
       - Code blocks have grey surface background
    5. Navigate to the About page and check:
       - Skill tags have grey surface background
       - Section headings are purple accent
       - Body text is readable
    6. Check header on all pages:
       - Site title is purple accent (#9b84ec)
       - Tagline text is muted grey
       - Nav links are grey, turn purple on hover
    7. Reload the page -- there should be NO flash of purple/different color before the page settles
    8. Overall: does the palette feel cohesive and readable? Note any elements that look "off" or still have purple tint
  </how-to-verify>
  <resume-signal>Type "approved" to complete Phase 1, or describe any visual issues you see</resume-signal>
</task>

</tasks>

<verification>
- Background color is #1e1f22 on all pages (not #262335)
- All surface colors are neutral greys (no purple tint)
- Critical CSS inline style matches :root values (no color flash)
- All text is readable against its background (WCAG AA verified in research)
- Scrollbar and selection use new palette (auto-propagated via CSS variables)
- Accent color is #9b84ec purple (not #ff7edb pink)
</verification>

<success_criteria>
- Complete palette migration: all 9 CSS custom properties updated
- Critical CSS synced: head.html inline style matches new palette
- Zero old palette values remain in source or compiled output
- Visual verification by user confirms no artifacts, no purple remnants, no color flash
- WCAG AA contrast maintained (pre-verified in research, confirmed by visual check)
</success_criteria>

<output>
After completion, create `.planning/phases/01-color-foundation/01-02-SUMMARY.md`
</output>
