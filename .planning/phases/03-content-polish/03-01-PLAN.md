---
phase: 03-content-polish
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - _sass/custom.scss
  - _sass/_syntax-highlighting.scss
  - assets/css/style.scss
autonomous: true
requirements:
  - CNT-01

must_haves:
  truths:
    - "Code blocks in posts display language-specific syntax highlighting with distinct colors for keywords, strings, comments, numbers, and functions"
    - "Syntax colors are visually consistent with the Discord-style dark theme (no foreign light backgrounds or clashing palettes)"
    - "All syntax accent colors pass WCAG AA contrast (4.5:1 minimum) against the code block background"
  artifacts:
    - path: "_sass/_syntax-highlighting.scss"
      provides: "Complete Rouge token color mapping"
      contains: ".highlight"
    - path: "_sass/custom.scss"
      provides: "Syntax color CSS variables in :root"
      contains: "--syntax-green"
    - path: "assets/css/style.scss"
      provides: "Import chain including syntax highlighting"
      contains: "syntax-highlighting"
  key_links:
    - from: "_sass/_syntax-highlighting.scss"
      to: "_sass/custom.scss"
      via: "CSS variable references (var(--syntax-green), var(--accent), etc.)"
      pattern: "var\\(--syntax-"
    - from: "assets/css/style.scss"
      to: "_sass/_syntax-highlighting.scss"
      via: "@import directive"
      pattern: "@import.*syntax-highlighting"
---

<objective>
Add syntax highlighting CSS for Rouge-generated code blocks so that fenced code blocks in posts display language-specific token coloring that fits the dark theme.

Purpose: Code blocks currently render as flat white text on a dark surface. Adding token-level coloring makes code examples readable and professional -- keywords, strings, comments, and functions each get a distinct color.

Output: A new `_syntax-highlighting.scss` partial with complete Rouge token coverage, five new CSS variables for syntax accent colors, and an updated import chain in `style.scss`.
</objective>

<execution_context>
@/home/chris/.claude/get-shit-done/workflows/execute-plan.md
@/home/chris/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/03-content-polish/03-RESEARCH.md
@_sass/custom.scss
@assets/css/style.scss
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add syntax color CSS variables and create Rouge token stylesheet</name>
  <files>_sass/custom.scss, _sass/_syntax-highlighting.scss, assets/css/style.scss</files>
  <action>
1. In `_sass/custom.scss`, add five new CSS variables inside the existing `:root` block, after `--accent-dim`:

```scss
/* Syntax highlighting accents */
--syntax-green: #a8c97e;
--syntax-amber: #d4a05e;
--syntax-blue: #6eb5e0;
--syntax-red: #e06c75;
--syntax-gold: #e0c57e;
```

2. Create `_sass/_syntax-highlighting.scss` with the complete Rouge token color mapping from the research (03-RESEARCH.md "Code Examples" section). Key requirements:
   - Scope the outer wrapper rules to `.post-content .highlighter-rouge` and `.post-content figure.highlight` for margin-bottom (1.25rem) so they beat Minima's defaults.
   - The `.highlight` block sets `background: var(--bg-surface)`, `color: var(--text-primary)`, `border: 1px solid var(--border)`, `border-radius: 6px`.
   - Nested `pre` gets `margin: 0; padding: 1.25rem; overflow-x: auto;`.
   - Nested `code` gets `font-family: inherit; font-size: 0.85rem; background: transparent; padding: 0; color: inherit;`.
   - Token classes map to colors per the research table:
     - Comments (`.c`, `.c1`, `.cm`, `.cp`, `.cs`, `.ch`): `var(--text-muted)`, italic
     - Keywords (`.k`, `.kc`, `.kd`, `.kn`, `.kp`, `.kr`, `.kv`): `var(--accent)` (purple)
     - Keyword type (`.kt`): `var(--syntax-amber)`
     - Strings (`.s`, `.s1`, `.s2`, `.sb`, `.sc`, `.sd`, `.sh`, `.sx`, `.dl`): `var(--syntax-green)`
     - Regex (`.sr`): `var(--syntax-amber)`
     - String interpolation (`.si`): `var(--syntax-green)`
     - String escape (`.se`): `var(--syntax-amber)`
     - Numbers (`.m`, `.mf`, `.mh`, `.mi`, `.mo`, `.mb`, `.mx`, `.il`): `var(--syntax-amber)`
     - Functions (`.nf`, `.fm`): `var(--syntax-blue)`
     - Classes/namespaces (`.nc`, `.nn`): `var(--syntax-gold)`
     - Built-ins (`.nb`, `.bp`): `var(--syntax-blue)`
     - Attributes (`.na`): `var(--syntax-blue)`
     - Constants (`.no`): `var(--syntax-amber)`
     - Exceptions (`.ne`): `var(--syntax-red)`
     - HTML tags (`.nt`): `var(--syntax-red)`
     - Variables (`.nv`, `.vi`, `.vg`, `.vc`): `var(--text-primary)`
     - Labels (`.nl`): `var(--syntax-blue)`
     - Operators (`.o`, `.ow`): `var(--text-primary)`, font-weight 500
     - Diff deleted (`.gd`): `var(--syntax-red)`
     - Diff inserted (`.gi`): `var(--syntax-green)`
     - Generic emphasis (`.ge`): italic
     - Generic strong (`.gs`): bold
     - Generic heading (`.gh`): `var(--text-primary)`, font-weight 500
     - Generic subheading/output/prompt (`.gu`, `.go`, `.gp`): `var(--text-muted)`
     - Error (`.err`): `var(--syntax-red)`
     - Punctuation (`.p`, `.pi`): `var(--text-primary)`
     - Whitespace (`.w`): `var(--text-primary)`

3. In `assets/css/style.scss`, add `@import "syntax-highlighting";` AFTER the existing `@import "custom";` line. This ensures syntax styles override both Minima's built-in syntax highlighting and any competing rules in custom.scss.
  </action>
  <verify>
Run `bundle exec jekyll build` and confirm:
- Build succeeds with no errors
- `_site/assets/css/style.css` contains `.highlight` rules with `var(--syntax-green)` references
- `_site/assets/css/style.css` contains all five `--syntax-` CSS variables in `:root`
- No Minima light-theme `.highlight { background: #fff }` appears AFTER the custom rules (check specificity order in compiled CSS)
  </verify>
  <done>
A complete syntax highlighting stylesheet exists with 60+ Rouge token classes mapped to the site's CSS variable palette. Five new syntax accent colors are defined in :root. The import chain is correct (minima -> custom -> syntax-highlighting). Code blocks in posts render with colored tokens instead of flat white text.
  </done>
</task>

</tasks>

<verification>
1. `bundle exec jekyll build` succeeds without errors
2. Inspect `_site/assets/css/style.css` -- confirm `.highlight` rules appear and reference `var(--syntax-*)` variables
3. If any blog posts contain code blocks, verify the generated HTML contains `<span>` elements with Rouge token classes (`.k`, `.s`, `.c`, etc.) that now have CSS rules targeting them
4. Confirm no white/light backgrounds leak through from Minima's default syntax highlighting
</verification>

<success_criteria>
- Code blocks display syntax-highlighted tokens with distinct colors for keywords (purple), strings (green), comments (muted/italic), numbers (amber), functions (blue), and classes (gold)
- Syntax colors use CSS variables, not hardcoded hex values (except in :root definitions)
- All syntax accent colors are WCAG AA compliant against --bg-surface (#2b2d31)
- The import order in style.scss ensures custom syntax rules override Minima defaults
</success_criteria>

<output>
After completion, create `.planning/phases/03-content-polish/03-01-SUMMARY.md`
</output>
